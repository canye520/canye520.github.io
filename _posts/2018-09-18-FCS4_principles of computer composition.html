---
layout: post
title:  "计算机科学导论(4):计算机组成原理"
date:   2018-09-17 08:24:00
categories: Computer_Science Computer_Science_Introduction
excerpt: "计算机硬件由中央处理单元、存储器、输入/输出单元、总线、输入/输出控制器构成"
---

<div class="post-style">

<p>上两章我们介绍了计算机的主要组成部分——数据，阐述了计算机是如何存储和运算各种类型数据的。本章我们将简要介绍计算机的另一个组成部分——计算机硬件，可以说，这个部分是计算机中最基础，也是最重要的部分，因为无论是数据能以何种方式存储和运算，还是计算机软件能实现哪些功能、发挥哪些效用，都取决于计算机硬件。</p>

<p>在第一章中，我们提到：当今的计算机硬件几乎都基于冯·诺依曼模型。冯·诺依曼模型指出计算机硬件由算术逻辑单元（ALU）、控制单元、存储器、输入/输出单元五大部分构成。事实上，今天我们熟知的 <strong>中央处理单元</strong>（Central Processing Unit,CPU）包括了算术逻辑单元、控制单元和部分存储器，其中部分存储器指的就是寄存器。除了寄存器外，<strong>存储器</strong>还包括主存和高速缓冲存储器。<strong>输入/输出单元</strong>则包括键盘、鼠标、操作杆、监视器、打印机等非存储设备以及磁盘、光盘等存储设备。这些独立的部分需要相互连接才能构成一个完整的计算机硬件系统，用于连接中央处理单元和存储器的是<strong>总线</strong>，用于连接输入/输出单元与中央处理单元和存储器的是<strong>输入/输出控制器</strong>。因此，我们说：计算机硬件系统由中央处理单元、存储器、输入/输出单元、总线和输入/输出控制器构成。 </p>

<h1>4.1 中央处理单元</h1>

<p>中央处理单元是计算机硬件系统的核心，主要用于数据的运算。一般而言，中央处理单元由算术逻辑单元、控制单元、寄存器这三大部分构成。后面在讲到存储器时我们还将看到：除了以上三大部分，现今计算机的中央处理单元还包括高速缓冲存储器。图 4-1 向我们展示了中央处理单元的基本构造。</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Computer_Science/Introduction/cpu.png"></p>
<p class="post-text-tablename">图 4-1 中央处理单元（CPU）</p>

<p><strong>算术逻辑单元</strong>用于对数据进行逻辑、移位和算术运算，关于这三种运算的具体含义详见博文<a href="/computer_science/computer_science_introduction/2018/08/01/FCS3_data-operation.html">《计算机科学导论(3):数据运算》</a>。</p>

<p><strong>控制单元</strong>用来控制算术逻辑单元、存储器和输入/输出单元，控制是通过从控制单元到其他子系统的信号实现的。</p>

<p><strong>寄存器</strong>是用来存放临时数据的高速存储器，分为数据寄存器、指令寄存器（IR）和程序计数器（PR）。<strong>数据寄存器</strong>用来存储输入数据和运算结果，<strong>指令寄存器</strong>用来存储从内存中取出的指令，<strong>程序计数器</strong>用来保存当前执行的指令，当前指令执行完后计数器自动加 1，指向下一条指令的内存地址。</p>

<p>CPU 利用重复的<strong>机器周期</strong>来执行程序中的指令，简单来说，一个机器周期包括取指令、译码和执行三个步骤。在<strong>取指令</strong>阶段，控制单元依据程序计数器中保存的下一条指令地址，将下一条将要执行的指令复制到指令寄存器（IR）中。复制完成后，程序计数器（PR）自动加 1 指向内存中的下一条指令。在<strong>译码</strong>阶段，控制单元将存储在指令寄存器（IR）中的指令翻译为可执行的二进制代码。在<strong>执行</strong>阶段，控制单元依据可执行代码发送任务命令到 CPU 的某个部件，例如让算术逻辑单元执行加法运算并保存结果到寄存器中。图 4-2 向我们展示了机器周期的步骤。</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Computer_Science/Introduction/machine_cycle.png"></p>
<p class="post-text-tablename">图 4-2 机器周期的步骤</p>

<h1>4.2 存储器</h1>

<p>本章中我们所讲的存储器是计算机中内部用来存储数据的器件，它不包括我们通常提到的硬盘、光盘等外部存储设备，在本章中，这些外部存储设备将在输入/输出单元下讲述。事实上，笔者觉得在这里，将存储器改为内部存储器，或许要更准确一些。但在本章中，笔者仍将与 Behrouz Forouzan 先生所著的 《计算机科学导论》 保持一致，采用 “存储器” 一词指代内部存储器件，在此特别强调一下，望读者明晰。</p>

<p>计算机需要许多的存储器，尤其是又快又便宜的存储器，然而遗憾的是：速度与价钱水火不相容，速度越快价格也越高。解决的办法是：用少量高速存储器来存储需要快速访问的数据（如：<strong>寄存器</strong>），用适量的中速存储器来存储需要经常访问的数据（如：<strong>高速缓冲存储器</strong>），用大量低速存储器存储不经常访问的数据（如：<strong>主存</strong>）。图 5-4 向我们展示了存储器的层次结构。</p>

<blockquote><strong>高速缓冲存储器</strong>简称缓存，其英文名为 cache. cache 一词来源于 1967 年的一篇电子工程期刊论文。其作者将法语词 “cache” 赋予 “safekeeping storage” 的涵义，用于电脑工程领域。</blockquote>

<blockquote>当 CPU 要存取主存（main memory,我们通常说的内存）中的<strong>字</strong>（字是 CPU 一次存取的位组，现在大部分 CPU 一次存取的位组长度已达到 64 位）时，它会首先检查缓存，如果缓存中存在就从缓存中存取，如果不存在，就从主存中复制一份从需要读取的字开始的数据块到缓存，而后从缓存中复制该字。提供 “缓存” 的目的就是为了让数据存取的速度适应 CPU 的处理速度。</blockquote>

<blockquote>CPU 的缓存曾经是用在超级计算机上的一种高级技术，不过现今电脑上使用的的 AMD 或 Intel 微处理器都在芯片内部集成了大小不等的数据缓存和指令缓存，通称为 L1 缓存（L1 Cache 即 Level 1 On-die Cache，第一级片上高速缓冲存储器）；而比 L1 更大容量的 L2 缓存曾经被放在 CPU 外部（主板或者 CPU 接口卡上），但是现在已经成为 CPU 内部的标准组件；更昂贵的 CPU 会配备比 L2 缓存还要大的 L3 缓存。</blockquote>

<blockquote>如今缓存的概念已被扩充，不仅在 CPU 和主内存之间有 Cache，而且在内存和硬盘之间也有 Cache（磁盘缓存），乃至在硬盘与网络之间也有某种意义上的 Cache——Internet临时文件夹或网络内容缓存等。<strong>凡是位于速度相差较大的两种硬件之间，用于协调两者数据传输速度差异的结构，均可称之为 Cache. </strong>
</blockquote>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Computer_Science/Introduction/memory_structure.png"></p>
<p class="post-text-tablename">图 4-3 存储器的层次结构</p>

<p>主存与缓存均是<strong>随机存取存储器</strong>（Random-access Memory,RAM）,用户可对其进行读写操作，但当系统断电后，存储器中的所有信息就不复存在了。主存使用<strong>动态 RAM 技术</strong>（DRAM），它使用<strong>电容器</strong>充放电状态的不同表示 1 和 0，充电时为 1，放电时为 0。但由于电容器会随着时间的流逝而漏掉一部分电，因此内存单元需要周期性地刷新，速度较慢，价格也相应较低。缓存使用<strong>静态 RAM 技术</strong>（SRAM），它使用传统的<strong>触发器门电路</strong>保存数据，这些门保持 0 或 1 的状态，通电时数据始终存在，无需刷新，因而速度较快，价格也相应较高。至于其中原理以及究竟什么是触发器门电路，笔者还不得而知。</p>

<blockquote>与随机存取存储器对应的还有一种被称作<strong>只读存储器</strong>（Read-only Memory,ROM）的存储器件，顾名思义，用户只能对其进行读操作。它的一个重要特性是：数据不会随着电源的切断而丢失，因此 ROM 通常被用来存储那些在开机时需要运行的程序。另外还有可编程只读存储器（PROM）、可擦除可编程只读存储器（EPROM）以及<strong>电可擦除可编程只读存储器</strong>（EEPROM）等只读存储器，但这些只读器并不是只读的，一些甚至可以多次重写，它们之所以继续沿用只读存储器的名称可能是因为它们继承了 ROM 断电后不会丢失数据的特性。</blockquote>

<blockquote>用户借助一些特殊的设备可在 PROM 上进行一次写操作，此后便不可重写。EPROM 可借助一种可以发出紫外光的特殊仪器作多次重写。EEPROM 则可借用电子脉冲作多次重写而无需从计算机上拆下来，它与高速 RAM 技术一起，成为了 21 世纪以来最常用且发展最快的两种存储技术。 </blockquote>

<blockquote>EEPROM 的优秀性能，使得它不仅被广泛应用于需要经常擦除的 BIOS 芯片（BIOS 是基本输入输出系统的英文简称）以及<strong>闪存</strong>（闪存是一种特殊的、以宏块抹写的 EEPROM，我们常见的<strong>存储卡</strong>、<strong>U 盘</strong>均属于闪存设备）芯片上，而且使得它开始占领作为外部主要存储设备硬盘的市场（<strong>固态硬盘</strong>是一种主要以闪存作为永久性存储器的计算机存储设备，它具有低功耗、无噪音、抗震动、低热量的特点，其读写速度远高于传统机械硬盘，当然它也存在价格高、数据恢复困难以及随着写入次数增加读写速度减慢等缺点）。</blockquote>

<p>在本节的最后，我们来讲一下地址这个概念。存储器是存储单元的集合，每一个存储单元都有唯一的标识，这个标识就是<strong>地址</strong>。在存储器中存取每个字都需要相应的标识符，尽管在高级程序语言中程序员使用命名的方式区分字或一组字的集合，但在硬件层次上，每个字都是通过地址来标识的。所有的存储器中表示的独立的地址单元的总数称为<strong>地址空间</strong>。例如，一个 64 KB（$2^{16} = 65535$ Bytes）、字长为 1 字节 (1 Bytes = 8 bits) 的内存的地址空间的范围为 0~65535，它需要 16 位的位模式来确定地址。通常如果一个计算机有 N 个字节的存储空间，每个字的字节长为 M，则内存地址空间的范围为 0~N/M，需要 $\log_2 {\left(N/M \right)}$ 位的位模式来确定地址。</p>

<h1>4.3 输入/输出单元</h1>

<p>未完待续……</p>

</div>