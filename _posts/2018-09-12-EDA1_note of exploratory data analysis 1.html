---
layout: post
title:  "探索性数据分析(1):Python"
date:   2018-09-13 19:25:00
categories: Statistics Computer_Science Python
excerpt: "课程笔记"
---

<div class="post-style">

<h1>1.1 基础</h1>

<p>在讲述有关 Python 的基础性内容前，这里先列出 Python 中可能需要注意的一些特点： </p>

<ul>
<li>Python 使用缩进来组织代码块，按约定俗成的习惯，缩进长度为 4 个空格（1 个 Tab 键）；</li>
<li>Python 单行注释采用 #，多行注释采用三引号 “““ ””” 或 ‘‘‘ ’’’；</li>
<li>Python 对大小写敏感</li>
</ul>

<h2>1.1.1 数据类型</h2>

<p>Python 内置的数据类型有：整数（int）、浮点数（float）、布尔值（True False）、空值（None）、字符串（str）、元组（tuple）、列表（list）、字典（dict）和集合（set）</p>

<p>对于<strong>整数</strong>、<strong>浮点数</strong>、<strong>布尔值</strong>和<strong>空值</strong>，与其他语言是类似的，故不再赘述。这里只提一点，那就是 Python 中允许使用二进制、八进制和十六进制表示一个数，只不过需要在数的前面分别添加 “0b”、“0o” 和 “0x”。 </p>

<p>Python 中的<strong>字符串</strong>不仅可以使用单引号、双引号表示，还可以使用三引号表示。三引号的作用体现在两方面：一是对字符串中存在双引号字符的语句使用三引号，可避免使用转义符表示双引号字符；二是使用三引号且需要换行显示时，直接回车而无需使用转义回车符 “\n”。 另外如果字符串里面有很多字符都需要转义，就需要加很多 \，为了简化，Python 允许使用 r' '、r" " 和 r''' '''，在这种表示下，''、" "、''' ''' 内部的字符串将不会被转义。下图给出了相关的 Python 代码示例：</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_1.png"></p>

<p class="post-text-tablename">图 1-1 Python 代码示例之字符串</p>

<p><strong>元组</strong>和<strong>列表</strong>均是 Python 中用来表示有序列表的数据类型，分别使用小括号 () 和中括号 [] 表示。二者的根本区别在于前者是不可变对象，后者是可变对象。我们可以把这种有序列表看成为一个向量，但与 R 语言中对向量的要求不同，元组和列表中元素的数据类型不必保持一致。实际上，这一特性与 R 语言中的列表是类似的，但 R 语言自身内置的数据类型要比 Python 多，这导致 R 语言列表中元素的数据类型不仅可以像 Python 那样取整数、实数、布尔值、空值或列表，还可以取更为复杂的矩阵和类似于矩阵的数据框。图 1-2 给出了与元组相关的 Python 代码示例，图 1-3 则给出了与列表相关的 Python 代码示例。</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_2.png"></p>

<p class="post-text-tablename">图 1-2 Python 代码示例之元组</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_3.png"></p>

<p class="post-text-tablename">图 1-3 Python 代码示例之列表</p>

<p><strong>字典</strong>和<strong>集合</strong>是 Python 内置的数据类型中比较特别的两个，我们可以将字典看成是一个由<strong>键</strong>（key）向量和<strong>值</strong> (value) 向量构成的二维数组，而将集合看成是一个由键构成的无序不重复序列。需要特别强调的是：键的数据类型只能为整数、实数、布尔值、空值、字符串等不可变对象，通常情况下我们使用的都是字符串。图 1-4 给出了与字典相关的 Python 代码示例，图 1-5 则给出了与集合相关的 Python 代码示例。</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_4.png"></p>

<p class="post-text-tablename">图 1-4 Python 代码示例之字典</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_5.png"></p>

<p class="post-text-tablename">图 1-5 Python 代码示例之集合</p>

<h2>1.1.2 变量与常量</h2>

<p>Python 中变量的命名规则与 C 语言是一致的，在博文<a href="/computer_science/c/2018/05/22/C1_Introduction-of-C.html">《C语言(1):初识C语言》</a>中已有详细说明，这里不再赘述。在 Python 中，可以把任意类型的数据赋值给变量，这种变量本身类型不固定的语言称之为<strong>动态语言</strong>，而像 C、Java 这种变量类型固定，即使用变量前必须声明变量类型的语言称之为<strong>静态语言</strong>。</p>

<p>Python 中实际上不存在内置常量，我们定义的常量本质上仍是变量，只是为了区分所谓变量与常量，我们约定常量的名称使用大写字母。</p>

<h2>1.1.3 字符编码</h2>

<p>在计算机内存中，通常使用 Unicode 编码（每个字符的字节数一致），而当需要保存到硬盘或进行传输时，通常使用基于 Unicode 码的 UTF-8 编码（不同字符的字节数可能不一致），关于 Unicode 码与 UTF-8 编码以及其他编码的关系详见博文<a href="/computer_science/computer_science_introduction/2018/07/15/FCS2_data-storage.html">《计算机科学导论(2):数据存储》</a>，这里不再赘述。</p>

<p>在 Python 中，字符串（str）是以 Unicode 编码的，使用函数 ord() 可以获得字符对应的 Unicode 码，使用函数 chr() 则可以获得 Unicode 码对应的字符。如果知道字符的 Unicode 码，在创建字符串时可以直接输入 Unicode 码，其显示效果与输入字符一致。</p>

<p>由于 Python 的字符串类型是 str，在内存中以 Unicode 表示，一个字符对应若干个字节。如果要在网络上传输，或者保存到磁盘上，就需要把 str 变为以字节为单位的 bytes，而如果要在网络上或磁盘上读取字节流，则需要把 bytes 转换为 str.</p>

<p>Python 中对 bytes 类型的数据用 b'' 或 b"" 表示。使用函数 encode() 可以将 str 转变为 bytes，使用函数 decode() 也可以将 bytes 转为 str，如果其中存在无法编码的字符或字节，Python 会报错，此时如果无法编码的字符或字节较少，可以通过增加参数 errors='ignore' 忽略错误。图 1-6 给出了与字符编码相关的 Python 示例代码。</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_6.png"></p>
<p class="post-text-tablename">图 1-6 Python 代码示例之字符编码</p>

<p>此外当 Python 解释器读取源代码时，为了让它按 UTF-8 编码读取，我们通常在文件开头处写上如下两行：

</div>

<div class="code-style">

{% highlight Python %}
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
{% endhighlight %}

</div>

<div class="post-style">

<p class="post-text-noindent">第一行注释是为了告诉Linux/OS X 系统，这是一个 Python 可执行程序，Windows 系统会忽略这个注释；第二行注释是为了告知 Python 解释器按照 UTF-8 编码读取源代码。
</p>

<h2>1.1.4 输出格式化字符串</h2>

<p>Python 中对字符串的格式化输出与 C 语言基本一致，只在语法格式上存在细微差别，下面是示例代码：</p>

</div>

<div class="code-style">

{% highlight Python %}

#!/usr/bin/env python3
# -*- coding: utf-8 -*-

#BMI指数计算器
height = input('\n这是一个BMI指数计算器\n\n请您在输入数据时不要加单位\n\n现在，请输入您的身高（单位：cm），然后按回车键：\n',)
weight = input('\n接下来，请输入您的体重（单位：kg），然后按回车键：\n',)
height = float(height)
weight = float(weight)
BMI = weight/pow(height*0.01,2)

if BMI < 18.5:
	TYPE='过轻'
elif 18.5 <= BMI < 24:
	TYPE='正常'
elif 23 <= BMI < 27:
	TYPE='过重'
elif 27 <= BMI <= 30:
	TYPE='肥胖'
else:
	TYPE='严重肥胖'

print("\n您的BMI指数 = %.2f，属 \"%s\" 类型" % (BMI,TYPE)) #切记不要加逗号！！！

{% endhighlight %}

</div>

<div class="post-style">

<h2>1.1.5 条件判断与循环</h2>

<p>Python 中的条件判断以及循环与其他语言区别不大，即使有区别也只是语法格式上的细微区别，Python 的条件判断采用通常的 if-elif-else 语句，循环采用通常的 for 循环和 while 循环，在循环中可采用 break 语句结束整个循环，也可采用 continue 语句跳出当次循环。其中，在 for 循环中，迭代对象可以是字符串、列表、元组、其他内置可迭代对象（<strong>如 range(start,stop,step) 代表从 start 开始以步长 step 到 stop 的序列，若省略 start 参数，则 start 为 1，若省略 step 参数，则 step 为 1，stop 参数不可省</strong>），以及用户通过类创建的新对象。
下面是示例代码：</p>

</div>

<div class="code-style">

{% highlight Python %}

#!/usr/bin/env python3
# -*- coding: utf-8 -*-

sum = 0
for x in [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]:
    sum = sum + x
print(sum)

sum = 0
for x in range(11):
    sum = sum + x
print(sum)

sum = 0
n = 99
while n > 0:
    sum = sum + n
    n = n - 2
print(sum)

n = 1
while n <= 100:
    if n > 10: # 当n = 11时，条件满足，执行break语句
        break # break语句会结束当前循环
    print(n)
    n = n + 1
print('END')

n = 0
while n < 10:
    n = n + 1
    if n % 2 == 0: # 如果n是偶数，执行continue语句
        continue # continue语句会直接继续下一轮循环，后续的print()语句不会执行
    print(n)

{% endhighlight %}

</div>

<div class="post-style">

<h1>1.2 函数</h1>

<p>上一节中我们介绍了 Python 的数据类型、变量与常量、字符编码、字符格式化输出以及条件判断与循环等基础内容，这一节我们将主要介绍 Python 函数，包括： Python 的内置函数、自定义函数和递归函数，并且我们将在自定义函数部分重点讲述 Python 函数可以使用的五大参数类型。</p>

<h2>1.2.1 内置函数</h2>

<p>Python 中有 69 个内置函数（built-in functions）,例如用于求绝对值、最大值的 abs()、max()；用于转换数据类型的 int()、float()、str()、bool() 等等，表 1-7 列出了这些内置函数。</p>

<p class="post-text-tablename">表 1-7 Python 内置函数</p>
<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/built_in_functions.png"></p>

<p class="post-text-noindent">我们可以通过<a href="http://docs.python.org/3/library/functions.html#abs">访问官网</a>或使用 help(function_name) 命令获知这些内置函数的作用及使用方法。另外，在 Python 中，我们可以把函数名赋给一个变量，这相当于给函数起了一个<strong>别名</strong>，以后我们调用函数时可以使用这个别名替代原有名称。</p>

<h2>1.2.2 自定义函数</h2>

<p>在 Python 中，函数自定义的基本格式如下所示：</p>

</div>

<div class="code-style">

{% highlight Python %}

#!/usr/bin/env python3
# -*- coding: utf-8 -*-

def function_name(arg):
    function_body
    return var_name

{% endhighlight %}

</div>

<div class="post-style">

<p class="post-text-noindent">其中 return 语句可以省略，当省略时，函数返回值为 None. 这里，我们要重点讲一下的是函数的<strong>参数</strong>（arg）。 在 Python 函数中，参数的类型多达 5 种，按定义的顺序依次为：必选参数、默认参数、可变参数、命名关键字参数和关键字参数</p>

<p><strong>必选参数</strong>即我们通常意义下的参数，<strong>默认参数</strong>即我们通常意义下的给定了默认值的参数，这里不做过多叙述，但要特别强调的一点是：默认参数必须指向不可变对象，否则将会导致如图 1-8 所示的类似问题：</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_7.png"></p>
<p class="post-text-tablename">图 1-8 Python 函数默认参数指向可变对象时的问题</p>

<p><strong>可变参数</strong>指的是传入参数个数可变（可为 0 个）的参数，由符号 * 和参数名构成，这些可变参数在函数调用时自动组装为一个 tuple. 图 1-9 展示了含可变参数的函数的定义方法和使用方法。</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_8.png"></p>
<p class="post-text-tablename">图 1-9 含可变参数的 Python 函数的定义及使用方法</p>

<p><strong>关键字参数</strong>由符号 ** 和参数名构成，与可变参数一样，它允许传入 0 个或任意个含参数名的参数，它的不同之处体现在：这些关键字参数在函数调用时自动组装为一个 dict 而非 tuple. 图 1-10 展示了含关键字参数的函数的定义方法和使用方法。</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_9.png"></p>
<p class="post-text-tablename">图 1-10 含关键字参数的 Python 函数的定义及使用方法</p>

<p><strong>命名关键字参数</strong>通常由分隔符 * 和参数名构成，在函数参数中包含可变参数的情况下可仅由参数名构成，它主要用来限制关键字参数的名字。在调用函数时命名关键字参数必须传入参数名，否则系统将会报错，另外，命名关键字参数还可以设置默认值。图 1-11 展示了含命名关键字参数的函数的定义方法和使用方法。</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_10.png"></p>
<p class="post-text-tablename">图 1-11 含命名关键字参数的 Python 函数的定义及使用方法</p>

<p>如有必要，在 Python 中定义函数时可以使用几种乃至全部参数类型，但必须遵循参数定义的顺序：必选参数、默认参数、可变参数、命名关键字参数和关键字参数。图 1-12 展示了含各种参数的函数的定义方法和使用方法。</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_11.png"></p>
<p class="post-text-tablename">图 1-12 含各种参数的 Python 函数的定义及使用方法</p>

<h2>1.2.3 递归函数</h2>

<p>如果一个函数在其内部调用自身，则我们称这样的函数为<strong>递归函数</strong>，例如：</p>

</div>

<div class="code-style">

{% highlight Python %}

#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# 递归求阶乘
def frac(n):
	if n == 1:
		return 1
	return n*frac(n-1)

# 递归解决著名的汉诺塔问题
def hanoi(n, a, b, c):
    if n == 1:
        print(a, '-->', c)
    else:
        hanoi(n - 1, a, c, b)
        print(a, '-->', c)
        hanoi(n - 1, b, a, c)

{% endhighlight %}

</div>

<div class="post-style">

<blockquote><a href="https://baike.baidu.com/item/%E6%B1%89%E8%AF%BA%E5%A1%94/3468295"><strong>汉诺塔</strong></a>问题：汉诺塔（又称河内塔）问题是源于印度一个古老传说的益智玩具。大梵天创造世界的时候做了三根金刚石柱子，在一根柱子上从下往上按照大小顺序摞着 64 片黄金圆盘。大梵天命令婆罗门把圆盘从下面开始按大小顺序重新摆放在另一根柱子上。并且规定，在小圆盘上不能放大圆盘，在三根柱子之间一次只能移动一个圆盘。</blockquote>

<p class="post-text-noindent">我们可以看到递归函数实际上相当于一个循环，但相较于循环的写法，使用递归在逻辑上显得更为清晰。但值得注意的是：递归只能用来实现少量循环，当循环次数过大时，将会出现栈溢出现象。在计算机中，函数调用是通过<strong>栈</strong>（stack）这种数据结构实现的，<strong>每当进入一个函数调用，栈就会加一层栈帧，每当函数返回，栈就会减一层栈帧</strong>。由于栈的大小不是无限的，所以，递归调用的次数过多，会导致栈溢出。</p>

<h1>1.3 高级特性</h1>

<p>上面我们介绍了 Python 的一些基础性内容以及 Python 函数，本节，我们将介绍 Python 的一些高级特性，包括：<strong>切片</strong> (slice)、<strong>列表生成式</strong> (list comprehensions)、<strong>生成器</strong> (generator)、<strong>迭代器</strong> (iterator) 和<strong>可迭代对象</strong> (iterable)。相信通过本节的学习，你将能够写出更为简洁、更易维护的 Python 代码，小伙伴们，还等什么，就让我们抓紧扶手，即刻出发，开赴战场，亟拯斯民于水火，切扶大厦之将倾！</p>

<h2>1.3.1 切片</h2>

<p>Python 为列表 (list)、元组 (tuple) 和字符串 (str) 等数据类型提供了切片 (slice) 操作符，从而大大简化了从这些数据中提取子集的过程。若 L 为一个列表，则 L[start:stop:step] 将从列表的第 (start+1) 个元素开始到列表的第 (stop) 个元素结束，每隔 (step-1) 个元素提取一个，这些提取出来的元素将被组成一个新的列表。下面给出的是一个用来实现去除字符串首尾空格的 Python 自定义函数示例，其中使用了切片操作。</p>

</div>

<div class="code-style">

{% highlight Python %}

#!/usr/bin/env python3
# -*- coding: utf-8 -*-

def trim(s):
    i = 0
    ls = len(s)
    j = ls - 1
    if ls > 0:
        while s[i]==' ':
            i += 1
            if i >= ls:
                break
        while s[j]==' ' and i < ls:
            j -= 1
    return s[i:j+1]

{% endhighlight %}

</div>

<div class="post-style">

<h2>1.3.2 列表生成式</h2>

<p>列表生成式 (List Comprehensions) 是 Python 中内置的用来快速创建列表的方法。图 1-13 向我们展示了 Python 列表生成式的使用方法。</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_12.png"></p>
<p class="post-text-tablename">图 1-13 Python 列表生成式的使用方法</p>

<p class="post-text-noindent">通过上图，我们可以看到：通过将循环语句和条件判断语句引入列表，列表生成式大大简化了一些较复杂列表的生成步骤，使得程序更加清晰、简单而直观。</p>

<h2>1.3.3 生成器</h2>

<p>通过列表生成式我们可以快速创建一个列表，但受到内存的限制，列表的容量是有限的。那 Python 中是否有方法创建一个容量无限的列表呢？答案是：可以创建，但此时创建的将不再是列表对象，而是一种被称之为生成器（generator）的对象。它可以依据事先定义好的列表元素生成规则，通过 next() 函数或循环语句不断生成新的列表元素。创建生成器的方法有两种：一是将列表生成器中的方括号 [] 换成圆括号 (); 二是在自定义函数中使用关键字 yield.图 1-14 向我们展示了 Python 生成器的定义及使用方法。</p>

<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_13_1.png"></p>
<p class="post-text-center"><img src="/assets/img/Natural_Science/Statistics/python_code_13_2.png"></p>
<p class="post-text-tablename">图 1-14 Python 生成器的定义及使用方法</p>

<h2>1.3.4 迭代器与可迭代对象</h2>

<p>我们将可以被 next() 函数调用并不断返回下一个值的对象称为迭代器 (iterator) ，而将可以直接作用于 for 循环的对象统称为可迭代对象 (iterable). 上节提到的生成器 (generator) 都是迭代器，但集合数据类型 list、tuple、dict、set、str 虽然是可迭代对象，却不是迭代器。可以使用 isinstance() 判断一个对象是否为迭代器或可迭代对象。</p>

<p>为什么 list、dict、str 等数据类型不是 Iterator？这是因为 Python 的 Iterator 对象表示的是一个数据流，Iterator 对象可以被 next() 函数调用并不断返回下一个数据，直到没有数据时抛出 StopIteration 错误。可以把这个数据流看做是一个有序序列，但我们却不能提前知道序列的长度，只能不断通过 next() 函数实现按需计算下一个数据，所以 Iterator 的计算是惰性的，只有在需要返回下一个数据时它才会计算。</p>

<p>另外，Python 的 for 循环本质上就是通过不断调用 next() 函数实现的。代码</p>
</div>

<div class="code-style">

{% highlight Python %}

#!/usr/bin/env python3
# -*- coding: utf-8 -*-

for x in [1, 2, 3, 4, 5]:
    pass

{% endhighlight %}

</div>

<div class="post-style">

<p class="post-text-noindent">实际上等价于</p>

</div>

<div class="code-style">

{% highlight Python %}

# 首先获得Iterator对象:
it = iter([1, 2, 3, 4, 5])
# 循环:
while True:
    try:
        # 获得下一个值:
        x = next(it)
    except StopIteration:
        # 遇到StopIteration就退出循环
        break

{% endhighlight %}

</div>

<div class="post-style"></div>

<!--


<h1>1.3 Numpy 库</h1>

<p>import numpy as np</p>

<p>创建数组：np.array([[1,2,3,4],[5,6,7,8],[7,8,9,10]])</p>
-->
<p>未完待续……</p>

</div>